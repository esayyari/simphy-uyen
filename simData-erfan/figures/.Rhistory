print(g[g$V2<400, ]$V1)
q<-read.csv('../data/parameter.log.info',header=T,sep=" ")
print(h[h$medianSeqLen<300,1])
print(h[h$medianSeqLen>2000,1])
q<-read.csv('../data/parameter.log.info1',header=T,sep=" ")
head(q)
head(d)
nrow(d)
g<-dcast(data=d,formula = V1~.,fun.aggregate=median)
head(g)
names(g)<-c("V1","V2")
merge(d,g,by.x=V1,by.y=Rep)
head(d)
merge(d,g,by.x=V1,by.y=Replicate)
merge(g,d,by.x=V1,by.y=Replicate)
merge(g,d,by.x="V1",by.y="Replicate")
head(g)
merge(g,d,by.x=V1,by.y=Replicate)
merge(x=g,y=d,by.x=V1,by.y=Replicate)
merge(x=g,y=d,by.x="V1",by.y="Replicate")
head(g)
head(d)
merge(x=g,y=q,by.x="V1",by.y="Replicate")
allInfo<-merge(x=g,y=q,by.x="V1",by.y="Replicate")
head(allInfo)
allInfo$V3<-allInfo$V2*allInfo$Generations*allInfo$Global_substitution_rate
reorder(allInfo$V1,allInfo$V3)
k<-reorder(allInfo$V1,allInfo$V3)
k[1]
k[2]
k[306]
k[306,]
allInfo[306,"V3"]
allInfo[329,"V3"]
allInfo[276,"V3"]
allInfo[185,"V3"]
allInfo[2,"V3"]
allInfo$V3<-allInfo$V2*allInfo$Generations*allInfo$Global_substitution_rate/(log(allInfo$Number_of_leaves))
k<-reorder(allInfo$V1,allInfo$V3)
k
allInfo[2,"V3"]
allInfo[306,"V3"]
allInfo$V3<-allInfo$V2*allInfo$Generations*allInfo$Global_substitution_rate/(sqrt(allInfo$Number_of_leaves))
k<-reorder(allInfo$V1,allInfo$V3)
k
allInfo[2,"V3"]
allInfo[306,"V3"]
length(allInfo$V3<0.3035917)
length(allInfo$V3<0.3)
length(which(allInfo$V3<0.3))
length(which(allInfo$V3<0.3035917))
allInfo$V3<-allInfo$V2*allInfo$Generations*allInfo$Global_substitution_rate/((allInfo$Number_of_leaves))
allInfo[2,"V3"]
length(which(allInfo$V3<0.0267))
allInfo[185,"V3"]
length(which(allInfo$V3<0.0129))
allInfo$V3<-allInfo$V2*allInfo$Generations*allInfo$Global_substitution_rate/allInfo$Haploid_efective_population_size/((allInfo$Number_of_leaves))
allInfo[2,"V3"]
length(which(allInfo$V3<2.895542e-08))
allInfo[185,"V3"]
length(which(allInfo$V3<4.170117e-08))
d
g
print(g[g$V2<400,])
nrow(g[g$V2<400,])
q
head(q)
nrow(q[q$trueGT<0.35,])
q[q$trueGT<0.35,]
q[q$trueGT<0.35,"Replicate"]
print(g[g$V2<400,])
print(g[g$V2<400,"V1"])
print(g[g$V2>2000,"V1"])
d
g
g[139,]
setwd('../../simphy-uyen/data/')
setwd('../simData-erfan/figures/')
d<-read.csv('../data/gtError-simphy-uyen.csv1',sep=' ',header=F)
d<-read.csv('../../data/gtError-simphy-uyen.csv1',sep=' ',header=F)
head(d)
source("../R/setup.r");
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
d<-d[!(d$V7 %in% "-"),]
d$V6<-as.numeric(as.character(d$V6))
d$V7<-as.numeric(as.character(d$V7))
d$V8<-as.numeric(as.character(d$V8))
d$V9<-as.numeric(as.character(d$V9))
d$V10<-as.numeric(as.character(d$V10))
d$V11<-as.numeric(as.character(d$V11))
ggplot(data=d,aes(x=rf,color=V2,linetype=V4))+geom_density()+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
ggplot(data=d,aes(x=rf,color=V2,linetype=V4))+geom_density()+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
head(d)
setwd(dirname(sys.frame(1)$ofile))
d$rf=as.numeric((d$V7+d$V10)/(d$V6+d$V9))
ggplot(data=d,aes(x=rf,color=V2,linetype=V4))+geom_density()+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
d<-read.csv('../../data/compareSpVsGenes.score.csv1',sep=' ',header=F)
d<-read.csv('../../data/gtError-simphy-uyen.csv1',sep=' ',header=F)
source("../R/setup.r");
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
d<-d[!(d$V7 %in% "-"),]
d$V6<-as.numeric(as.character(d$V6))
d$V7<-as.numeric(as.character(d$V7))
d$V8<-as.numeric(as.character(d$V8))
d$V9<-as.numeric(as.character(d$V9))
d$V10<-as.numeric(as.character(d$V10))
d$V11<-as.numeric(as.character(d$V11))
d$rf=as.numeric((d$V7+d$V10)/(d$V6+d$V9))
head(d)
levels(d$V3)
levels(d[d$V3 %in% "1.5",]$V1)
levels(d[d$V3 %in% "1.5",]$V2)
ggplot(data=d[d$V3 %in% "1.5" && !(d$V2 %in% "0"),],aes(x=rf,color=V2,linetype=V4))+geom_density()+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
head(d)
ggplot(data=d[d$V4 %in% "1.5" && !(d$V2 %in% "0"),],aes(x=rf,color=V2))+geom_density()+theme_bw()+
facet_wrap(~V1)
d[d$V4 %in% "1.5",]
gplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
gplot(data=d[d$V4 %in% "1.5",],aes(x=rf,fill=V2))+geom_density(alpha=0.5)+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,fill=V2))+geom_density(alpha=0.5)+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,fill=V2))+geom_density(alpha=0.5)+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+xlab('RF distance (true vs estimated)')
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+xlab('RF distance (true vs estimated)')
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+theme(legend.position = "below")
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+xlab('RF distance (true vs estimated)')
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+theme(legend.position = "bottom")
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+xlab('RF distance (true vs estimated)')
?theme
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+theme(legend.position = "bottom")+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+xlab('RF distance (true vs estimated)')
head(d)
d.sum = summarySE(d,measurevar="rf",groupvars=c("V1","V2","V4","V5"),na.rm=T,conf.interval=.95)
head(d.sum)
d.sum$rf = as.numeric(d.sum$rf)
cdat <- ddply(d.sum, c("V1","V2","V3","V5"), summarise, rating.mean=mean(rf))
cdat <- ddply(d.sum, c("V1","V2","V4","V5"), summarise, rating.mean=mean(rf))
cdat
head(cdat)
cdat <- ddply(d.sum, c("V1","V2","V4"), summarise, rating.mean=mean(rf))
head(cdat)
cdat[,4]<-as.numeric(cdat[,4])
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+theme(legend.position = "bottom")+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[cdat$V1 %in% c(0,1),],
aes(xintercept=rating.mean, colour=V2),size=1,linetype="dashed")
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+theme_bw()+theme(legend.position = "bottom")+
facet_wrap(~V1)+scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, colour=V2),size=1,linetype="dashed")
head(cdat)
levels(cdat$V1)
levels(cdat$V4)
levels(cdat$V2)
head(cdat)
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, color=V2),size=1,linetype="dashed")+facet_wrap(~V1)
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, color=V2),size=1,linetype="dashed")+facet_wrap(~V1)
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, color=V2),size=1,linetype="dashed")+facet_wrap(~V1)
nrow(cdat)
nrow(d)
cdat <- ddply(d.sum, c("V1","V2","V4","V5"), summarise, rating.mean=mean(rf))
head(cdat)
cdat[,5]<-as.numeric(cdat[,5])
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, color=V2),size=1,linetype="dashed")+facet_wrap(~V1)
d<-read.csv('../../data/compareSpVsGenes.score.csv1',sep=' ',header=F)
d$V1<-as.factor(d$V1);
d<-read.csv('../../data/gtError-simphy-uyen.csv1',sep=' ',header=F)
source("../R/setup.r");
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
d<-d[!(d$V7 %in% "-"),]
d$V6<-as.numeric(as.character(d$V6))
d$V7<-as.numeric(as.character(d$V7))
d$V8<-as.numeric(as.character(d$V8))
d$V9<-as.numeric(as.character(d$V9))
d$V10<-as.numeric(as.character(d$V10))
d$V11<-as.numeric(as.character(d$V11))
d$rf=as.numeric((d$V7+d$V10)/(d$V6+d$V9))
d.sum = summarySE(d,measurevar="rf",groupvars=c("V1","V2","V4","V5"),na.rm=T,conf.interval=.95)
d.sum$rf = as.numeric(d.sum$rf)
cdat <- ddply(d.sum, c("V1","V2","V4","V5"), summarise, rating.mean=mean(rf))
cdat[,5]<-as.numeric(cdat[,5])
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, color=V2),size=1,linetype="dashed")+facet_wrap(~V1)
cdat <- ddply(d.sum, c("V1","V2","V4"), summarise, rating.mean=mean(rf))
cdat[,4]<-as.numeric(cdat[,4])
head(cdat)
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, color=V2),size=1,linetype="dashed")+facet_wrap(~V1)
unique(cdat[cdat$V1 %in% "31",]$V2)
cdat[cdat$V1 %in% "31",]$V2
cdat[cdat$V1 %in% "31",]$V2
cdat[cdat$V1 %in% "31" && cdat$V4 %in% "1.5",]$V2
cdat[cdat$V1 %in% "31" & cdat$V4 %in% "1.5",]$V2
cdat[cdat$V1 %in% "31" & cdat$V4 %in% "1.5",]$rf
cdat[cdat$V1 %in% "31" & cdat$V4 %in% "1.5",]
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+geom_vline(data=cdat[d$V4 %in% "1.5",],
aes(xintercept=rating.mean, color=V2),size=1,linetype="dashed")+facet_wrap(~V1)
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
head(d)
ggplot(data=d,aes(x=interaction(V2,V3),y=rf))+geom_boxplot()+facet_wrap(~V1)
ggplot(data=d,aes(x=interaction(V2,V3),y=rf))+geom_bar()+facet_wrap(~V1)
ggplot(data=d,aes(x=interaction(V2,V3),y=rf))+geom_boxplot()+facet_wrap(~V1)
ggplot(data=d,aes(x=interaction(V2,V3),y=rf))+geom_boxplot()+facet_wrap(~V1)
ggplot(data=d,aes(x=interaction(V2,V3),y=rf,color=interaction(V2,V3)))+geom_boxplot()+facet_wrap(~V1)
ggplot(data=d,aes(x=interaction(V2,V3),y=rf,fill=interaction(V2,V3)))+geom_boxplot()+facet_wrap(~V1)
ggplot(data=d,aes(x=interaction(V2,V3),y=rf,fill=interaction(V2,V3)))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")
?paste
d$method<-paste(d$V2,d$V3,sep="-")
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")
theme_bw()+theme(legend.position = "bottom",axis.text.x = element_text(face="bold", color="gray",
size=14, angle=90))+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold", color="gray", size=14, angle=90))+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")
theme_bw()+
theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")
theme_bw()+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold", color="gray", size=14, angle=90))+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold", color="gray", angle=90))+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="InOutRatio/SpHeter",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d[d$V4 %in% "1.5",],aes(x=rf,color=V2))+geom_density()+
theme_bw()+theme(legend.position = "bottom")+
scale_color_brewer(name="Outgroup to Ingroup ratio",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
d<-read.csv('../../data/outgroup-err.csv',sep=" ",header=F)
head(d)
d<-read.csv('../../data/outgroup-err.csv',sep=" ",header=F)
head(d)
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
head(d)
d$V6<-as.numeric(d$V6)
head(d)
?ecdf
geom_ecdf
head(d)
d<-read.csv('../../data/outgroup-err.csv',sep=" ",header=F)
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
head(d)
d$rat<-(d$V6-d$V7)/d$V6
head(d$rat)
ggplot(d, aes(x=rat)) + stat_ecdf(geom = "step")
head(d)
d$method<-paste(d$V2,d$V3,sep="-")
ggplot(d, aes(x=rat,color=method)) + stat_ecdf(geom = "step")
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step")
require(scales)
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step") +
scale_color_brewer(name="",palette="Dark2")
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step") +
scale_color_brewer(name="",palette="Dark2")+scale_y_continuous(labels = scales::percent)
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step") +
scale_color_brewer(name="",palette="Dark2")+
scale_y_continuous(labels = scales::percent)+xlab('Outgroup missplacement ratio')+
ylab('Percent of replicates')+theme_bw()+theme(legend.position='bottom')
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step") +
scale_color_brewer(name="",palette="Dark2")+
scale_y_continuous(labels = scales::percent)+xlab('Outgroup missplacement ratio')+
ylab('Percent of replicates')+theme_bw()+theme(legend.position='bottom')+facet_wrap(~V1)
ggsave('outgroup_ecdf.pdf')
f<-read.csv('quartetscore.csv',sep=" ",header=F)
f<-read.csv('../../data/quartetscore.csv',sep=" ",header=F)
head(f)
d<-read.csv('../../data/quartetscore.csv',sep=" ",header=F)
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
head(d)
d$method<-paste(d$V2,d$V3,sep="-")
ggplot(data=d,aes(x=method,y=V6,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggplot(data=d,aes(x=method,y=V6,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="",palette="Dark2")+ylab('QuartetScore')+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggsave('quartetScore.pdf')
ggplot(data=d,aes(x=method,y=V6,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="",palette="Dark2")+ylab('QuartetScore')+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggsave('quartetScore.pdf',height=6,width=3.6363)
ggplot(data=d,aes(x=method,y=V6,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="Ingroup outgroup ratio-species/genes heterogenity",palette="Dark2")+ylab('QuartetScore')+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggsave('quartetScore.pdf',height=6,width=3.6363)
ggsave('quartetScore.pdf',height=6,width=4)
ggsave('quartetScore.pdf',height=6,width=4)
ggsave('quartetScore.pdf',height=3.6363,width=6)
ggsave('quartetScore.pdf',height=4,width=6)
d<-read.csv('../../data/outgroup-err.csv',sep=" ",header=F)
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
d$V6<-as.numeric(d$V6);
d$method<-paste(d$V2,d$V3,sep="-")
head(d)
d$rat<-(d$V6-d$V7)/d$V6
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step")
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) +
stat_ecdf(geom = "step")+theme_bw()+scale_color_brewer(palette="Dark2")+
theme(legend.position="bottom")
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) +
stat_ecdf(geom = "step")+theme_bw()+scale_color_brewer(palette="Dark2")+
theme(legend.position="bottom")+facet_wrap()
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) +
stat_ecdf(geom = "step")+theme_bw()+scale_color_brewer(palette="Dark2")+
theme(legend.position="bottom")+facet_wrap(~V1)
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) +
stat_ecdf()+theme_bw()+scale_color_brewer(palette="Dark2")+
theme(legend.position="bottom")+facet_wrap(~V1)
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step") +
scale_color_brewer(name="",palette="Dark2")+
scale_y_continuous(labels = scales::percent)+xlab('Outgroup missplacement ratio')+
ylab('Percent of replicates')+theme_bw()+theme(legend.position='bottom')+facet_wrap(~V1)
ggplot(d[!(d$V2%in%"0"),], aes(x=rat,color=method)) + stat_ecdf(geom = "step") +
scale_color_brewer(name="Method",palette="Dark2")+
scale_y_continuous(labels = scales::percent)+xlab('Outgroup missplacement ratio')+
ylab('Percent of replicates')+theme_bw()+theme(legend.position='bottom')+facet_wrap(~V1)
ggsave('outgroup_ecdf.pdf',height=4,width=6)
ggsave('outgroup_ecdf.pdf',height=5,width=6)
ggsave('outgroup_ecdf.pdf',height=3.6,width=6)
ggsave('outgroup_ecdf.pdf',height=3.633,width=6)
ggsave('outgroup_ecdf.pdf',height=3.5,width=6)
ggsave('outgroup_ecdf.pdf',height=4,width=6.5)
ggsave('outgroup_ecdf.pdf',height=4,width=6.5)
d<-read.csv('../../data/gtError-simphy-uyen.csv1',sep=' ',header=F)
source("../R/setup.r");
d$V1<-as.factor(d$V1);
d$V2<-as.factor(d$V2);
d$V3<-as.factor(d$V3);
d$V4<-as.factor(d$V4);
d<-d[!(d$V7 %in% "-"),]
d$V6<-as.numeric(as.character(d$V6))
d$V7<-as.numeric(as.character(d$V7))
d$V8<-as.numeric(as.character(d$V8))
d$V9<-as.numeric(as.character(d$V9))
d$V10<-as.numeric(as.character(d$V10))
d$V11<-as.numeric(as.character(d$V11))
d$rf=as.numeric((d$V7+d$V10)/(d$V6+d$V9))
d.sum = summarySE(d,measurevar="rf",groupvars=c("V1","V2","V4","V5"),na.rm=T,conf.interval=.95)
d.sum$rf = as.numeric(d.sum$rf)
cdat <- ddply(d.sum, c("V1","V2","V4"), summarise, rating.mean=mean(rf))
cdat[,4]<-as.numeric(cdat[,4])
d$method<-paste(d$V2,d$V3,sep="-")
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="",palette="Dark2")+
xlab('RF distance (true vs estimated)')+facet_wrap(~V1)
ggsave('geneTreeError.pdf',width=5,height=6)
ggsave('geneTreeError.pdf',width=5,height=3)
ggsave('geneTreeError.pdf',width=6,height=3.6)
ggsave('geneTreeError.pdf',width=6,height=4)
ggsave('geneTreeError.pdf',width=6.5,height=4)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="Method",palette="Dark2")+
xlab('Method')+facet_wrap(~V1)+ylab('RF distance (true vs estimated)')
ggsave('geneTreeError.pdf',width=6.5,height=4)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "right",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="Method",palette="Dark2")+
xlab('Method')+facet_wrap(~V1)+ylab('RF distance (true vs estimated)')
ggsave('geneTreeError.pdf',width=6.5,height=4)
ggplot(data=d,aes(x=method,y=rf,fill=method))+
geom_boxplot()+facet_wrap(~V1)+scale_fill_brewer(name="",palette="BuPu")+
theme_bw()+
theme(legend.position = "bottom",
axis.text.x = element_text(face="bold",angle=90))+
scale_color_brewer(name="Method",palette="Dark2")+
xlab('Method')+facet_wrap(~V1)+ylab('RF distance (true vs estimated)')
ggsave('geneTreeError.pdf',width=6.5,height=4)
